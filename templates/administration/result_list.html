{% extends "../admin_base.html" %}
{% block content %}
<h2>Uploaded Results</h2>

<form method="POST" action="{% url 'approve_all_results' %}">
  {% csrf_token %}
  <button type="submit">Approve All Pending Results</button>
</form>

<table border="1" cellpadding="10" style="margin-top: 15px;">
  <tr>
    <th>Student</th>
    <th>Matric No</th>
    <th>Course</th>
    <th>Score</th>
    <th>Grade</th>
    <th>Status</th>
    <th>Submitted By</th>
    <th>Approved By</th>
    <th>Actions</th>
  </tr>

  {% for result in results %}
  <tr>
    <td>{{ result.registration.student.user.get_full_name }}</td>
    <td>{{ result.registration.student.matric_no }}</td>
    <td>{{ result.registration.course.code }} - {{ result.registration.course.title }}</td>
    <td>{{ result.score }}</td>
    <td>{{ result.grade }}</td>
    <td>{{ result.status }}</td>
    <td>{{ result.submitted_by.user.get_full_name|default:"lecturer" }}</td>
    <td>{{ result.approved_by.get_full_name|default:"admin" }}</td>
    <td>
      {% if result.status == 'Pending' %}
      <a href="{% url 'approve_result' result.id %}">Approve</a>
      {% else %}
      Approved
      {% endif %}
    </td>
  </tr>
  {% empty %}
  <tr><td colspan="9">No results found.</td></tr>
  {% endfor %}
</table>
{% endblock %}