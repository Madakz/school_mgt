{% extends "../admin_base.html" %}
{% block content %}
<h2>Uploaded Results</h2>


<div class="dashboard-content-one">
  <!-- Student Table Area Start Here -->
  <div class="card height-auto">
      <div class="card-body">
          <div class="heading-layout1">
              <div class="item-title">
                  <h3>Admin List</h3>
              </div>
              
          </div>
          
          <div class="col-1-xxxl col-xl-2 col-lg-3 col-12 form-group">
              <form method="POST" action="{% url 'approve_all_results' %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-primary">Approve All Pending Results</button>
              </form>
          </div>
          <div class="table-responsive">
              <table class="table display data-table text-nowrap">
                  <thead>
                      <tr>
                          <th>Student</th>
                          <th>Matric No</th>
                          <th>Course</th>
                          <th>Score</th>
                          <th>Grade</th>
                          <th>Status</th>
                          <th>Submitted By</th>
                          <th>Approved By</th>
                          <th>Actions</th>
                      </tr>
                  </thead>
                  <tbody>
                    {% for result in results %}
                      <tr>
                        <td>{{ result.registration.student.user.get_full_name }}</td>
                        <td>{{ result.registration.student.matric_no }}</td>
                        <td>{{ result.registration.course.code }} - {{ result.registration.course.title }}</td>
                        <td>{{ result.score }}</td>
                        <td>{{ result.grade }}</td>
                        <td>{{ result.status }}</td>
                        <td>{{ result.submitted_by.user.get_full_name|default:"lecturer" }}</td>
                        <td>{{ result.approved_by.get_full_name|default:"admin" }}</td>
                      
                        <td>
                            <div class="dropdown">
                                <a href="all-student.html#" class="dropdown-toggle" data-toggle="dropdown"
                                    aria-expanded="false">
                                    <span class="flaticon-more-button-of-three-dots"></span>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right">
                                  {% if result.status == 'Pending' %}
                                    <a class="dropdown-item" href="{% url 'approve_result' result.id %}"><i
                                            class="fas fa-cogs text-dark-pastel-green"></i>Approve</a>
                                  {% else %}
                                    <a class="dropdown-item" href="#"></a><i class="fas fa-cogs text-dark-pastel-green"></i>Approved</a>
                                  {% endif %}
                                </div>
                                <td>
      
                            </div>
                        </td>
                      </tr> 
                      {% empty %}
                      <tr><td colspan="9">No result found.</td></tr>
                      {% endfor %} 
                  </tbody>
              </table>
          </div>
      </div>
  </div>
</div>
{% endblock %}